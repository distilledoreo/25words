<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>25 Words - Multiplayer</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: white; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .clue-bubble { animation: pop 0.3s ease-out; }
        @keyframes pop {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- Firebase Init ---
        // Check if Firebase config is provided, otherwise use a placeholder for demo mode
        // Note: To use real Firebase functionality, define __firebase_config as a global variable
        // with your Firebase project credentials before this script runs
        const firebaseConfig = typeof __firebase_config !== 'undefined' 
            ? JSON.parse(__firebase_config)
            : {
                apiKey: "demo-api-key",
                authDomain: "demo-project.firebaseapp.com",
                projectId: "demo-project",
                storageBucket: "demo-project.appspot.com",
                messagingSenderId: "123456789",
                appId: "1:123456789:web:abcdef123456"
            };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // --- Game Data ---
        const WORD_SETS = [
            ["Astronaut", "Moon", "Rocket", "Gravity", "NASA"],
            ["Pizza", "Cheese", "Pepperoni", "Italy", "Crust"],
            ["Vampire", "Blood", "Dracula", "Fangs", "Coffin"],
            ["Beach", "Sand", "Ocean", "Sunblock", "Towel"],
            ["Wedding", "Bride", "Groom", "Cake", "Ring"],
            ["Baseball", "Bat", "Pitcher", "Homerun", "Strike"],
            ["Library", "Books", "Quiet", "Card", "Shelf"],
            ["Doctor", "Hospital", "Medicine", "Nurse", "Surgery"],
            ["Camping", "Tent", "Fire", "Marshmallow", "Woods"],
            ["Pirate", "Ship", "Treasure", "Parrot", "Eye Patch"],
            ["Christmas", "Tree", "Santa", "Presents", "Reindeer"],
            ["Dinosaur", "T-Rex", "Fossil", "Extinct", "Jurassic"],
            ["School", "Teacher", "Homework", "Recess", "Desk"],
            ["Zoo", "Animals", "Cage", "Keeper", "Tickets"],
            ["Movie", "Popcorn", "Screen", "Ticket", "Hollywood"],
            ["Superhero", "Cape", "Villain", "Powers", "Mask"],
            ["Computer", "Keyboard", "Mouse", "Screen", "Internet"],
            ["Farm", "Cow", "Barn", "Tractor", "Farmer"],
            ["Airport", "Plane", "Pilot", "Luggage", "Security"],
            ["Bowling", "Strike", "Ball", "Pins", "Shoes"]
        ];

        // --- Components ---
        
        // Fixed Icon component: Uses a Ref to manually inject SVG, avoiding React VDOM conflicts
        const Icon = ({ name, size = 24, className }) => {
            const containerRef = useRef(null);

            useEffect(() => {
                if (!window.lucide || !containerRef.current) return;

                const pascalName = name.split('-')
                    .map(part => part.charAt(0).toUpperCase() + part.slice(1))
                    .join('');

                const iconNode = window.lucide.icons ? window.lucide.icons[pascalName] : null;

                if (iconNode && typeof window.lucide.createElement === 'function') {
                    const svgElement = window.lucide.createElement(iconNode);
                    svgElement.setAttribute('width', size);
                    svgElement.setAttribute('height', size);
                    svgElement.setAttribute('stroke-width', 2);
                    
                    containerRef.current.innerHTML = '';
                    containerRef.current.appendChild(svgElement);
                }
            }, [name, size]);

            return <span ref={containerRef} className={`inline-flex items-center justify-center ${className || ''}`} style={{ width: size, height: size }}></span>;
        };

        const Button = ({ onClick, children, variant = "primary", className = "", disabled = false, type = "button" }) => {
            const baseStyle = "w-full py-3 rounded-lg font-bold transition-all active:scale-95 flex items-center justify-center gap-2";
            const variants = {
                primary: "bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/30",
                secondary: "bg-slate-700 hover:bg-slate-600 text-slate-200 border border-slate-600",
                danger: "bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-500/30",
                success: "bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/30",
                outline: "border-2 border-slate-500 text-slate-400 hover:border-slate-300 hover:text-white"
            };
            return (
                <button 
                    type={type}
                    onClick={onClick} 
                    disabled={disabled}
                    className={`${baseStyle} ${variants[variant]} ${disabled ? 'opacity-50 cursor-not-allowed' : ''} ${className}`}
                >
                    {children}
                </button>
            );
        };

        const App = () => {
            const [user, setUser] = useState(null);
            const [localPlayer, setLocalPlayer] = useState({ name: '', team: 'red' });
            const [roomCode, setRoomCode] = useState("");
            const [joined, setJoined] = useState(false);
            
            // Shared Game State
            const [gameState, setGameState] = useState({
                phase: 'lobby',
                scores: { red: 0, blue: 0 },
                currentWords: [],
                winningBid: 25,
                activeTeam: null,
                giverId: null,
                startTime: null,
                wordsGuessed: [false, false, false, false, false],
                usedWordCount: 0,
                cluesLog: []
            });

            const [clueInput, setClueInput] = useState("");

            // Auth
            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await auth.signInWithCustomToken(__initial_auth_token);
                        } else {
                            await auth.signInAnonymously();
                        }
                    } catch (error) {
                        console.warn('Firebase auth error (using demo mode):', error.message);
                        // Set a mock user to allow the app to function in demo mode
                        setUser({ uid: 'demo-user-' + Math.random().toString(36).substr(2, 9) });
                    }
                };
                initAuth();
                const unsubscribe = auth.onAuthStateChanged(u => {
                    if (u) setUser(u);
                });
                return () => unsubscribe();
            }, []);

            // Firestore Listener - DEPENDS ON JOINED AND ROOMCODE
            useEffect(() => {
                if (!user || !joined || !roomCode) return;
                
                const gameRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gamestate').doc(roomCode.toUpperCase());
                
                // Initialize if not exists
                gameRef.get().then((doc) => {
                    if (!doc.exists) {
                        gameRef.set({
                            phase: 'lobby',
                            scores: { red: 0, blue: 0 },
                            currentWords: [],
                            winningBid: 25,
                            activeTeam: null,
                            giverId: null,
                            startTime: null,
                            wordsGuessed: [false, false, false, false, false],
                            usedWordCount: 0,
                            cluesLog: []
                        });
                    }
                }).catch((error) => {
                    console.warn("Firebase initialization error (demo mode):", error.message);
                });

                const unsubscribe = gameRef.onSnapshot((doc) => {
                    if (doc.exists) setGameState(doc.data());
                }, (error) => {
                    console.warn("Firestore sync error (demo mode):", error.message);
                });

                return () => unsubscribe();
            }, [user, joined, roomCode]);

            // --- Game Actions (Firestore Updates) ---

            const updateGame = async (updates) => {
                if (!user || !roomCode) return;
                try {
                    await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gamestate').doc(roomCode.toUpperCase()).update(updates);
                } catch (error) {
                    console.warn("Firebase update error (demo mode):", error.message);
                    // In demo mode, update local state as fallback
                    setGameState(prev => ({ ...prev, ...updates }));
                }
            };

            const generateRoomCode = () => {
                const code = Math.random().toString(36).substring(2, 6).toUpperCase();
                setRoomCode(code);
            };

            const startGame = () => {
                const randomIndex = Math.floor(Math.random() * WORD_SETS.length);
                updateGame({
                    scores: { red: 0, blue: 0 },
                    currentWords: WORD_SETS[randomIndex],
                    wordsGuessed: [false, false, false, false, false],
                    usedWordCount: 0,
                    winningBid: 25,
                    phase: 'reveal',
                    cluesLog: [],
                    giverId: null,
                    activeTeam: null
                });
            };

            const nextRound = () => {
                const randomIndex = Math.floor(Math.random() * WORD_SETS.length);
                updateGame({
                    currentWords: WORD_SETS[randomIndex],
                    wordsGuessed: [false, false, false, false, false],
                    usedWordCount: 0,
                    winningBid: 25,
                    phase: 'reveal',
                    cluesLog: [],
                    giverId: null,
                    activeTeam: null
                });
            };

            const startPlaying = () => {
                updateGame({
                    phase: 'playing',
                    startTime: Date.now(),
                    cluesLog: []
                });
            };

            const becomeGiver = () => {
                if (!user) return;
                updateGame({ giverId: user.uid });
            };

            const submitClue = (e) => {
                e.preventDefault();
                if (!clueInput.trim()) return;

                const words = clueInput.trim().split(/\s+/);
                const count = words.length;

                const newLog = [...gameState.cluesLog, { 
                    text: clueInput, 
                    count: count, 
                    timestamp: Date.now(),
                    sender: localPlayer.name
                }];

                updateGame({
                    cluesLog: newLog,
                    usedWordCount: gameState.usedWordCount + count
                });
                setClueInput("");
            };

            const toggleWord = (index) => {
                if (!user || gameState.giverId !== user.uid) return;
                const newGuessed = [...gameState.wordsGuessed];
                newGuessed[index] = !newGuessed[index];
                updateGame({ wordsGuessed: newGuessed });
            };

            const submitRound = (success) => {
                const points = 250;
                let newScores = { ...gameState.scores };
                
                if (success) {
                    newScores[gameState.activeTeam] += points;
                } else {
                    const otherTeam = gameState.activeTeam === 'red' ? 'blue' : 'red';
                    newScores[otherTeam] += points;
                }
                
                updateGame({
                    scores: newScores,
                    phase: 'roundSummary'
                });
            };

            // --- Timer Logic ---
            const [timeLeft, setTimeLeft] = useState(45);
            
            useEffect(() => {
                if (gameState.phase !== 'playing' || !gameState.startTime) return;
                
                const interval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                    const remaining = Math.max(0, 45 - elapsed);
                    setTimeLeft(remaining);
                }, 500);

                return () => clearInterval(interval);
            }, [gameState.phase, gameState.startTime, user?.uid, gameState.giverId]);

            // --- Views ---

            if (!joined) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 bg-slate-900">
                        <div className="bg-slate-800 p-8 rounded-2xl w-full max-w-sm border border-slate-700 shadow-2xl">
                            <h1 className="text-3xl font-black text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-300">
                                JOIN GAME
                            </h1>
                            <div className="space-y-4">
                                <div>
                                    <label className="text-xs text-slate-400 font-bold uppercase">Your Name</label>
                                    <input 
                                        type="text" 
                                        className="w-full bg-slate-900 border border-slate-700 p-3 rounded-lg text-white mt-1"
                                        value={localPlayer.name}
                                        onChange={e => setLocalPlayer(p => ({...p, name: e.target.value}))}
                                        placeholder="Enter name..."
                                    />
                                </div>

                                <div>
                                    <label className="text-xs text-slate-400 font-bold uppercase">Room Code</label>
                                    <div className="flex gap-2 mt-1">
                                        <input 
                                            type="text" 
                                            className="flex-1 bg-slate-900 border border-slate-700 p-3 rounded-lg text-white uppercase font-mono tracking-widest text-center"
                                            value={roomCode}
                                            onChange={e => setRoomCode(e.target.value.toUpperCase())}
                                            placeholder="CODE"
                                            maxLength={6}
                                        />
                                        <button 
                                            onClick={generateRoomCode}
                                            className="bg-slate-700 text-white px-3 rounded-lg text-xs font-bold uppercase hover:bg-slate-600 transition-colors"
                                        >
                                            Generate
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <label className="text-xs text-slate-400 font-bold uppercase">Select Team</label>
                                    <div className="grid grid-cols-2 gap-3 mt-1">
                                        <button 
                                            onClick={() => setLocalPlayer(p => ({...p, team: 'red'}))}
                                            className={`p-3 rounded-lg border-2 font-bold ${localPlayer.team === 'red' ? 'bg-red-500/20 border-red-500 text-red-400' : 'bg-slate-900 border-slate-700 text-slate-500'}`}
                                        >
                                            Red Team
                                        </button>
                                        <button 
                                            onClick={() => setLocalPlayer(p => ({...p, team: 'blue'}))}
                                            className={`p-3 rounded-lg border-2 font-bold ${localPlayer.team === 'blue' ? 'bg-blue-500/20 border-blue-500 text-blue-400' : 'bg-slate-900 border-slate-700 text-slate-500'}`}
                                        >
                                            Blue Team
                                        </button>
                                    </div>
                                </div>
                                <Button disabled={!localPlayer.name || !roomCode} onClick={() => setJoined(true)}>Enter Lobby</Button>
                            </div>
                        </div>
                    </div>
                );
            }

            const renderLobby = () => (
                <div className="flex flex-col items-center justify-center h-screen p-6 text-center space-y-8 animate-pop">
                    <div className="space-y-2">
                         <h1 className="text-5xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-300">
                            25 WORDS
                        </h1>
                        <div className="bg-slate-800 px-4 py-2 rounded-lg border border-slate-700 inline-block">
                            <span className="text-slate-400 text-xs uppercase font-bold mr-2">Room Code:</span>
                            <span className="text-xl font-mono font-bold text-white tracking-widest">{roomCode}</span>
                        </div>
                        <p className="text-slate-400 text-sm mt-2">Waiting for players to join <strong>{roomCode}</strong>...</p>
                    </div>
                    
                    <div className="flex gap-4 w-full max-w-md">
                        <div className="flex-1 bg-red-900/10 border border-red-500/30 p-4 rounded-xl">
                            <h3 className="font-bold text-red-400 mb-2">Red Score</h3>
                            <span className="text-3xl font-black">{gameState.scores.red}</span>
                        </div>
                        <div className="flex-1 bg-blue-900/10 border border-blue-500/30 p-4 rounded-xl">
                            <h3 className="font-bold text-blue-400 mb-2">Blue Score</h3>
                            <span className="text-3xl font-black">{gameState.scores.blue}</span>
                        </div>
                    </div>

                    <div className="w-full max-w-xs">
                        <Button onClick={startGame}>Start New Game</Button>
                    </div>
                </div>
            );

            const renderReveal = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 animate-pop">
                    <div className="absolute top-4 right-4 bg-slate-800 px-3 py-1 rounded border border-slate-700 font-mono text-xs text-slate-400">
                        Room: {roomCode}
                    </div>
                    <h2 className="text-2xl font-bold mb-4 text-center">Giver Selection</h2>
                    <p className="text-slate-400 mb-8 text-center max-w-xs text-sm">
                        One person from each team should see the words to bid.
                    </p>

                    {gameState.giverId === user?.uid ? (
                        <div className="bg-slate-800 p-6 rounded-2xl w-full max-w-sm border border-slate-700 shadow-2xl mb-8 space-y-3">
                            <div className="text-center text-xs text-slate-500 uppercase font-bold mb-2">Secret Words</div>
                            {gameState.currentWords.map((word, i) => (
                                <div key={i} className="text-xl font-bold text-center border-b border-slate-700 pb-2 last:border-0 last:pb-0 text-emerald-400">
                                    {word}
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="bg-slate-800/50 p-8 rounded-2xl w-full max-w-sm border border-slate-700 border-dashed mb-8 text-center text-slate-500">
                            Waiting for Givers to review words...
                        </div>
                    )}

                    <div className="space-y-4 w-full max-w-xs">
                        {gameState.giverId !== user?.uid && (
                            <Button variant="secondary" onClick={becomeGiver}>
                                <Icon name="eye" size={18} /> I am a Giver
                            </Button>
                        )}
                        <Button onClick={() => updateGame({ phase: 'bidding' })}>
                            Proceed to Bidding
                        </Button>
                    </div>
                </div>
            );

            const renderBidding = () => (
                <div className="flex flex-col items-center min-h-screen p-6 max-w-md mx-auto animate-pop pt-12">
                     <div className="absolute top-4 right-4 bg-slate-800 px-3 py-1 rounded border border-slate-700 font-mono text-xs text-slate-400">
                        Room: {roomCode}
                    </div>
                    <h2 className="text-3xl font-black mb-2 text-slate-200">BIDDING</h2>
                    
                    {/* Only Giver sees words here */}
                    {gameState.giverId === user?.uid && (
                        <div className="w-full mb-6 bg-slate-900/50 p-3 rounded-lg border border-slate-800">
                            <div className="text-xs font-bold uppercase text-slate-500 mb-1">Reminder</div>
                            <div className="flex flex-wrap gap-2 justify-center">
                                {gameState.currentWords.map((w,i) => <span key={i} className="text-xs text-emerald-400 bg-slate-800 px-2 py-1 rounded">{w}</span>)}
                            </div>
                        </div>
                    )}

                    <div className="w-full space-y-6">
                        <div className="bg-slate-800 p-6 rounded-xl border border-slate-700">
                            <label className="block text-slate-400 text-xs font-bold uppercase mb-2">Winning Bid</label>
                            <div className="flex items-center justify-between gap-4">
                                <Button variant="secondary" onClick={() => updateGame({ winningBid: Math.max(1, gameState.winningBid - 1) })} className="w-16 h-16 rounded-full !p-0"><Icon name="minus" /></Button>
                                <span className="text-5xl font-mono font-bold w-20 text-center">{gameState.winningBid}</span>
                                <Button variant="secondary" onClick={() => updateGame({ winningBid: gameState.winningBid + 1 })} className="w-16 h-16 rounded-full !p-0"><Icon name="plus" /></Button>
                            </div>
                        </div>

                        <div>
                            <label className="block text-slate-400 text-xs font-bold uppercase mb-2">Winning Team</label>
                            <div className="grid grid-cols-2 gap-4">
                                <button 
                                    onClick={() => updateGame({ activeTeam: 'red' })}
                                    className={`p-6 rounded-xl border-4 font-black text-xl transition-all ${
                                        gameState.activeTeam === 'red' 
                                        ? 'bg-red-500/20 border-red-500 text-red-100' 
                                        : 'bg-slate-800 border-slate-700 text-slate-500'
                                    }`}
                                >
                                    RED
                                </button>
                                <button 
                                    onClick={() => updateGame({ activeTeam: 'blue' })}
                                    className={`p-6 rounded-xl border-4 font-black text-xl transition-all ${
                                        gameState.activeTeam === 'blue' 
                                        ? 'bg-blue-500/20 border-blue-500 text-blue-100' 
                                        : 'bg-slate-800 border-slate-700 text-slate-500'
                                    }`}
                                >
                                    BLUE
                                </button>
                            </div>
                        </div>

                        <Button 
                            disabled={!gameState.activeTeam} 
                            onClick={startPlaying}
                            variant={gameState.activeTeam === 'red' ? 'danger' : gameState.activeTeam === 'blue' ? 'primary' : 'secondary'}
                        >
                            Start Round
                        </Button>
                    </div>
                </div>
            );

            const renderPlaying = () => {
                const isGiver = user?.uid && gameState.giverId === user.uid;
                const isGuesser = !isGiver;
                
                return (
                    <div className={`flex flex-col h-screen overflow-hidden ${timeLeft === 0 ? 'bg-red-900/10' : ''}`}>
                        {/* Header */}
                        <div className="bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center shadow-lg shrink-0">
                            <div>
                                <div className="text-xs text-slate-400 uppercase font-bold">Limit</div>
                                <div className={`text-xl font-bold ${gameState.usedWordCount > gameState.winningBid ? 'text-red-500' : 'text-white'}`}>
                                    {gameState.usedWordCount} / {gameState.winningBid}
                                </div>
                            </div>
                            <div className={`text-4xl font-mono font-black ${timeLeft <= 10 ? 'text-red-500 animate-pulse' : 'text-white'}`}>
                                {timeLeft}s
                            </div>
                            <div className="text-right">
                                <div className="text-xs text-slate-400 uppercase font-bold">Team</div>
                                <div className={`text-xl font-black uppercase ${gameState.activeTeam === 'red' ? 'text-red-400' : 'text-blue-400'}`}>
                                    {gameState.activeTeam}
                                </div>
                            </div>
                        </div>

                        <div className="flex-1 flex flex-col overflow-hidden relative">
                            {/* Clue Log Area */}
                            <div className="flex-1 overflow-y-auto p-4 space-y-3 pb-32">
                                {gameState.cluesLog.length === 0 && (
                                    <div className="text-center text-slate-600 mt-10 italic">No clues given yet...</div>
                                )}
                                {gameState.cluesLog.map((log, idx) => (
                                    <div key={idx} className="flex flex-col items-start clue-bubble">
                                        <div className="bg-slate-700/80 rounded-2xl rounded-tl-none px-4 py-2 text-white border border-slate-600 shadow-sm max-w-[80%]">
                                            <span className="text-lg">{log.text}</span>
                                        </div>
                                        <span className="text-xs text-slate-500 mt-1 ml-2 font-mono">Count: {log.count}</span>
                                    </div>
                                ))}
                                <div id="clue-end"></div>
                            </div>

                            {/* Giver Overlay: Word List */}
                            {isGiver && (
                                <div className="absolute top-4 right-4 z-10 w-48 bg-slate-900/90 backdrop-blur border border-slate-700 p-3 rounded-xl shadow-2xl">
                                    <h4 className="text-xs font-bold text-slate-400 uppercase mb-2 border-b border-slate-700 pb-1">Target Words</h4>
                                    <div className="space-y-2">
                                        {gameState.currentWords.map((w, idx) => (
                                            <button 
                                                key={idx}
                                                onClick={() => toggleWord(idx)}
                                                className={`w-full text-left text-sm font-bold px-2 py-1 rounded transition-colors ${
                                                    gameState.wordsGuessed[idx] 
                                                    ? 'text-emerald-500 line-through opacity-50' 
                                                    : 'text-white hover:bg-slate-800'
                                                }`}
                                            >
                                                {w}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}

                             {/* Guesser Status Overlay */}
                             {isGuesser && (
                                <div className="absolute top-4 right-4 z-10">
                                    <div className="bg-slate-800/80 backdrop-blur px-3 py-1 rounded-full border border-slate-600 text-xs font-bold text-emerald-400 flex items-center gap-2">
                                        <Icon name="check-circle" size={14} />
                                        {gameState.wordsGuessed.filter(Boolean).length} / 5 Solved
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Input / Controls Area */}
                        <div className="bg-slate-800 p-4 border-t border-slate-700 shrink-0">
                            {isGiver ? (
                                <div className="space-y-4">
                                    <form onSubmit={submitClue} className="flex gap-2">
                                        <input 
                                            autoFocus
                                            type="text" 
                                            value={clueInput}
                                            onChange={e => setClueInput(e.target.value)}
                                            placeholder="Type clue here..."
                                            className="flex-1 bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"
                                        />
                                        <Button type="submit" className="!w-auto px-6">Send</Button>
                                    </form>
                                    <div className="flex gap-2">
                                        <Button variant="danger" className="text-xs" onClick={() => submitRound(false)}>Fail</Button>
                                        <Button 
                                            variant="success" 
                                            className="text-xs" 
                                            onClick={() => submitRound(true)}
                                            disabled={!gameState.wordsGuessed.every(Boolean) && gameState.usedWordCount <= gameState.winningBid}
                                        >
                                            Success
                                        </Button>
                                    </div>
                                </div>
                            ) : (
                                <div className="text-center text-slate-500 text-sm py-2 animate-pulse">
                                    Waiting for Giver to type...
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const renderSummary = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 animate-pop">
                    <h2 className="text-3xl font-bold mb-8">Scoreboard</h2>
                    
                    <div className="flex gap-6 w-full max-w-md mb-12">
                        <div className="flex-1 bg-red-900/30 border-2 border-red-500 rounded-2xl p-6 flex flex-col items-center relative overflow-hidden">
                            <div className="absolute top-0 w-full h-2 bg-red-500"></div>
                            <h3 className="text-red-400 font-bold mb-2">RED</h3>
                            <span className="text-6xl font-black text-white">{gameState.scores.red}</span>
                        </div>
                        <div className="flex-1 bg-blue-900/30 border-2 border-blue-500 rounded-2xl p-6 flex flex-col items-center relative overflow-hidden">
                            <div className="absolute top-0 w-full h-2 bg-blue-500"></div>
                            <h3 className="text-blue-400 font-bold mb-2">BLUE</h3>
                            <span className="text-6xl font-black text-white">{gameState.scores.blue}</span>
                        </div>
                    </div>

                    <div className="w-full max-w-xs space-y-4">
                        <Button onClick={nextRound}>Next Round</Button>
                        <Button variant="outline" onClick={() => { setJoined(false); setRoomCode(""); }}>Leave Room</Button>
                    </div>
                </div>
            );

            // Router
            switch(gameState.phase) {
                case 'lobby': return renderLobby();
                case 'reveal': return renderReveal();
                case 'bidding': return renderBidding();
                case 'playing': return renderPlaying();
                case 'roundSummary': return renderSummary();
                default: return renderLobby();
            }
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
